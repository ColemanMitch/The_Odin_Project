!function(){let e=0,t=0;const o=({id:e,title:t,desc:o,project:l,dueDate:r,priority:n,complete:i})=>({id:e,title:t,desc:o,project:l,dueDate:r,priority:n,complete:i,toggleComplete(){this.complete=!i},changePriority(){this.priority=3}}),l=({id:e,title:t,toDos:o})=>({title:t,toDos:o,pushToDo(e){return this.toDos.push(e),this},deleteToDo(e){return this.toDos.splice(e,1),this}});let r,n=l({id:t++,title:"Tasks",toDos:[o({id:e++,title:"Laundry",desc:"My clothes is dirty!",project:"Tasks",dueDate:"2020-12-03",priority:2,complete:!1}),o({id:e++,title:"Vacuum",desc:"The rug is grody!",project:"Tasks",dueDate:"2020-12-03",priority:3,complete:!0})]}),i=l({id:t++,title:"",toDos:[]});function d(){let e,t=this.parentNode.parentNode.childNodes[1].innerText,o=document.getElementById("project-list-header").innerText;if("All ToDos"!==o)e=r.projects.filter((e=>e.title===o))[0];else{let t=this.parentNode.parentNode.dataset.id;for(let o of r.projects)for(let l of o.toDos)String(l.id)===String(t)&&(e=o)}for(let o=0;o<e.toDos.length;o++)if(e.toDos[o].title===t){e.toDos.splice(o,1);break}this.parentNode.parentNode.remove(),window.localStorage.setItem("user",JSON.stringify(r)),r=JSON.parse(window.localStorage.getItem("user"))}function s(){let e,t,o,l=this.parentNode.parentNode.parentNode.childNodes[1].innerText,n=document.getElementById("project-list-header").innerText,i=this.parentNode.parentNode.parentNode.childNodes[1],d=this.parentNode.parentNode.parentNode.childNodes[2];if(this.parentNode.parentNode.parentNode.childNodes[1],"All ToDos"!==n)e=r.projects.filter((e=>e.title===n))[0];else{let t=this.parentNode.parentNode.parentNode.dataset.id;console.log(t);for(let o of r.projects)for(let l of o.toDos)String(l.id)===String(t)&&(e=o)}for(let r=0;r<e.toDos.length;r++)if(e.toDos[r].title===l){e.toDos[r].complete=!e.toDos[r].complete,t=e.toDos[r].complete,o=e.toDos[r].priority;break}window.localStorage.setItem("user",JSON.stringify(r)),r=JSON.parse(window.localStorage.getItem("user")),function(e,t,o,l){o?(e.style.textDecoration="line-through",t.style.textDecoration="line-through",e.parentNode.style.backgroundColor="#c6f78d"):(e.style.textDecoration="initial",t.style.textDecoration="initial",String(l)===String(3)?e.parentNode.style.backgroundColor="#f78d8d":String(l)===String(2)?e.parentNode.style.backgroundColor="#f7c68d":String(l)===String(1)?e.parentNode.style.backgroundColor="#f7f38d":(console.log("back to normal color"),e.parentNode.style.backgroundColor="#F8F9FC"))}(i,d,t,o)}function c(){toDoRows=document.getElementById("to-dos-table"),function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(toDoRows)}function a(e){document.getElementById("delete-project-list-btn").style.visibility="visible";let t=document.getElementById("to-dos-table");for(let o of e.toDos){let e=document.createElement("tr");String(o.priority)===String(3)?e.style.backgroundColor="#f78d8d":String(o.priority)===String(2)?e.style.backgroundColor="#f7c68d":String(o.priority)===String(1)&&(e.style.backgroundColor="#f7f38d"),o.complete&&(e.style.backgroundColor="#c6f78d"),e.setAttribute("class","odd"),e.dataset.id=o.id,e.setAttribute("role","row");let l=document.createElement("td");l.setAttribute("colspan","1");let r=document.createElement("form"),n=document.createElement("input");n.setAttribute("type","checkbox"),o.complete?n.checked=!0:n.checked=!1,n.style.cursor="pointer",n.addEventListener("click",s,!0),r.appendChild(n),l.append(r);let i=document.createElement("td");i.setAttribute("colspan","8"),i.textContent=o.title;let c=document.createElement("td");c.setAttribute("colspan","2"),c.textContent=o.dueDate,o.complete&&(i.style.textDecoration="line-through",c.style.textDecoration="line-through");let a=document.createElement("td");a.setAttribute("colspan","1");let p=document.createElement("i");p.setAttribute("class","fas fa-edit"),p.id="edit-"+String(o.id),p.dataset.toggle="modal",p.dataset.target="#to-do-edit-modal",p.style.cursor="pointer";let u=document.createElement("i");u.setAttribute("class","fas fa-trash-alt"),u.style.cursor="pointer",u.addEventListener("click",d,!0),a.appendChild(p),a.appendChild(u),e.appendChild(l),e.appendChild(i),e.appendChild(c),e.appendChild(a),t.append(e)}}window.localStorage.getItem("user")?(console.log("Local Storage of User exists"),r=JSON.parse(window.localStorage.getItem("user")),console.log(r)):(console.log("Local Storage of User don't exists"),r=(({projects:e})=>({projects:e,addProject(e){return this.projects.push(e),this},deleteProject(e){return this.projects.splice(e,1),this}}))({projects:[n,i]})),a(r.projects[0]),document.getElementById("Tasks-pl").addEventListener("click",(function(){c(),console.log(this),r=JSON.parse(window.localStorage.getItem("user"));let e=r.projects.filter((e=>e.title===this.innerText))[0];var t;console.log(e),t=e,document.getElementById("project-list-header").innerText=t.title,a(e)}),!0),$((function(){let e;$("table").on("click",".fas.fa-edit",(function(t){let o,l=t.target.parentNode.parentNode,n=document.getElementById("project-list-header").innerText;console.log(n),console.log(l.dataset.id);let i=!1;if("All ToDos"===n){i=!0;let e=l.dataset.id;console.log(e);for(let t of r.projects)for(let l of t.toDos)String(l.id)===String(e)&&(o=t)}else o=r.projects.filter((e=>e.title===n))[0];console.log(o);let p=l.cells[1].textContent,u=l.cells[2].textContent;e=o.toDos.filter((e=>String(e.id)===l.getAttribute("data-id")))[0],console.table(e);let g=e.desc,m=e.priority;$("#new-to-do-edit").val(p),$("#new-due-date-edit").val(u),$("#new-desc-edit").val(g),$("#new-priority-edit").val(m);let f=document.getElementById("edit-save-btn");$(f).off().on("click",(function(){console.log(p),e.title=document.getElementById("new-to-do-edit").value,e.desc=document.getElementById("new-desc-edit").value,e.dueDate=document.getElementById("new-due-date-edit").value,e.priority=document.getElementById("new-priority-edit").value,console.log(e),console.log(o),c(),window.localStorage.setItem("user",JSON.stringify(r)),r=JSON.parse(window.localStorage.getItem("user")),i?function(){document.getElementById("project-list-header").innerText="All ToDos",document.getElementById("delete-project-list-btn").style.visibility="hidden",console.log("need to refresh the table to show all todos ordered by id"),allToDos=[];for(let e of r.projects)console.log(e),allToDos=allToDos.concat(e.toDos);console.log(allToDos),c();let e=document.getElementById("to-dos-table");for(let t of allToDos){let o=document.createElement("tr");String(t.priority)===String(3)?o.style.backgroundColor="#f78d8d":String(t.priority)===String(2)?o.style.backgroundColor="#f7c68d":String(t.priority)===String(1)&&(o.style.backgroundColor="#f7f38d"),t.complete&&(o.style.backgroundColor="#c6f78d"),o.setAttribute("class","odd"),o.dataset.id=t.id,o.setAttribute("role","row");let l=document.createElement("td");l.setAttribute("colspan","1");let r=document.createElement("form"),n=document.createElement("input");n.setAttribute("type","checkbox"),t.complete?n.checked=!0:n.checked=!1,n.style.cursor="pointer",n.addEventListener("click",s,!0),r.appendChild(n),l.append(r);let i=document.createElement("td");i.setAttribute("colspan","8"),i.textContent=t.title;let c=document.createElement("td");c.setAttribute("colspan","2"),c.textContent=t.dueDate,t.complete&&(i.style.textDecoration="line-through",c.style.textDecoration="line-through");let a=document.createElement("td");a.setAttribute("colspan","1");let p=document.createElement("i");p.setAttribute("class","fas fa-edit"),p.id="edit-"+String(t.id),p.dataset.toggle="modal",p.dataset.target="#to-do-edit-modal",p.style.cursor="pointer";let u=document.createElement("i");u.setAttribute("class","fas fa-trash-alt"),u.style.cursor="pointer",u.addEventListener("click",d,!0),a.appendChild(p),a.appendChild(u),o.appendChild(l),o.appendChild(i),o.appendChild(c),o.appendChild(a),e.append(o)}}():a(o),$("#to-do-edit-modal").modal("hide")}))}))}))}();